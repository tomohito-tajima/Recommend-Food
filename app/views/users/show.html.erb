<main>
  <div class="container">
    <div class="row">
      <div class="col-md-4">
        <div class="d-flex justify-content-center">
          <h4 style="background-color: #2C7CFF; text-align: center; padding: 10px 20px; margin: 10px 0; color: #FFFFFF;">
            <!--カレントユーザが自身の詳細を見ている時は「マイページ」-->
            <% if user_signed_in? && current_user.id.to_s == params[:id] %>
              <strong>マイページ</strong>
            <!--他のユーザのマイページを見るときは「○○さんのマイページ-->
            <% else %>
              <strong><%= @user.name %>さんのマイページ</strong>
            <% end %>
          </h4>
        </div>

        <div style = "text-align: center; margin: 10px 0 30px 0;">
          <%= attachment_image_tag @user, :profile, :fill, 250, 150, format: 'jpg', fallback: "no_image.jpg" %>
        </div>

        <table class="table" align="center">
          <tbody>
            <tr>
              <td style = "text-align: center; padding: 15px 0;">名前</td>
              <td style = "text-align: center; padding: 15px 0;"><%= @user.name %></td>
            </tr>

            <tr>
              <td style = "text-align: center; padding: 15px 0;">好きな食べ物</td>
              <td style = "text-align: center; padding: 15px 0;"><%= @user.favorited_food %></td>
            </tr>

            <tr>
              <td style = "text-align: center; padding: 15px 0;">自己紹介</td>
              <td style = "text-align: center; padding: 15px 0;"><%= @user.introduction %></td>
            </tr>

            <tr>
              <td style = "text-align: center; padding: 15px 0;">フォロー数： <%= @user.followings.count %></td>
              <td style = "text-align: center; padding: 15px 0;">フォロワー数：<%= @user.followers.count %></td>
            </tr>

            <tr>
              <td style = "padding: 15px 0; text-align: center;"><%= link_to "フォロー一覧", user_followings_path(@user.id) %></td>
              <td style = "padding: 15px 0; text-align: center;"><%= link_to "フォロワー一覧", user_followers_path(@user.id) %></td>
            </tr>
          </tbody>
        </table>

        <h4 style="text-align: center; margin: 20px auto; text-center" >
          <% if user_signed_in? && current_user.id.to_s == params[:id] %>
            <%= link_to "マイページを変更", edit_user_path(@user.id), class: "btn btn-sm btn-success" %>
          <% end %>
        </h4>
      </div>

      <div class="col-md-7 offset-md-1">
        <div class="d-flex justify-content-center">
          <!--カレントユーザがログイン時のみ表示させる-->
          <% if user_signed_in? && current_user.id.to_s == params[:id] %>
            <h4 style="text-align: center; margin: 20px auto;">
              <%= link_to "お気に入りFood一覧", likes_foods_path, class: "btn btn-block btn-sm btn-warning" %>
            </h4>

            <h4 style="text-align: center; margin: 20px auto;">
              <%= link_to "新規投稿する", new_food_path, class: "btn btn-block btn-sm btn-success" %>
            </h4>
          <% else %>
            <div style="text-align: right;">
              <% if current_user.following?(@user) %>
                <%= link_to "フォロー外す", user_relationships_path(@user.id), method: :delete, class: "btn btn-block btn-sm btn-danger" %>
              <% else %>
                <%= link_to "フォローする", user_relationships_path(@user.id), method: :post, class: "btn btn-block btn-sm btn-primary" %>
              <% end %>
            </div>
          <% end %>
        </div>

        <div class="d-flex justify-content-center">
          <!--カレントユーザなら「あなた」、他ユーザなら「○○さんの投稿一覧」-->
          <!--他のユーザが見たときのみ、フォローボタンを追加-->
          <% if user_signed_in? && current_user.id.to_s == params[:id] %>
            <div>
              <h4 style="border-bottom: solid; border-color: #000000;"><strong>あなたが投稿した一覧</strong></h4>
            </div>
          <% else %>
            <div>
              <h4 style="border-bottom: solid; border-color: #000000;"><%= @user.name %>さんが投稿した一覧</h4>
            </div>
          <% end %>
        </div>

        <div>
          <table class="table table-hover table-bordered">
              <thead>
                <tr>
                  <th></th>
                  <th style="text-align: center;">お店名</th>
                  <th style="text-align: center;">いいね数</th>
                  <th></th>
                </tr>
              </thead>

            <% @foods.each do |food| %>
              <tbody>
                <tr>
                  <td style = "text-align: center;"><%= attachment_image_tag food, :image, :fill, 60, 60, format: 'jpg', fallback: "no_image.jpg" %></td>
                  <td style="text-align: center; padding: 20px 0;"><%= food.name %></td>
                  <td style="text-align: center; padding: 20px 0; color: red;">♥<%= food.likes.count %></td>
                  <td style="text-align: center; padding: 20px 0;"><%= link_to "詳細", food_path(food.id), class: "btn btn-block btn-sm btn-primary" %></td>
                </tr>
              </tbody>
            <% end %>
          </table>
        </div>
      </div>
    </div>
  </div>
</main>

